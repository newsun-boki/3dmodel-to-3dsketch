# 3D model -> 3D sketch

## Environment
This project is build in MacOS, but Windows/linux should work well.


+ Blender 3.6
+ open3d
+ openexr
+ Imath

For MacOS, you could install openexr by 
```bash
brew install openexr

# These environment variables are required for OpenEXR pip package to compile
export CFLAGS="-I/opt/homebrew/include/OpenEXR -I/opt/homebrew/include/Imath -std=c++11"
export LDFLAGS="-L/opt/homebrew/lib"

pip install openexr
```
## Setup

+ A mesh model (possibly generated by [Wonder3D](https://github.com/xxlong0/Wonder3D.git))
+ Then convert the mesh to .ply
## Steps

1. Genrate Multi-view Depth Image from Model.
```bash
#source ~/.bash_profile
blender -b -P render_depth.py
```
you could set the data and output path in 
```python
model_dir = 'plys/buildings' #line95 in render_depth.py
output_dir = "output"#line96 in render_depth.py
```
The results are stored in `./output`
2. Visualize the EXR results to get the depth image
```bash
python plot_exr.py
```
3. Apply edge detection and get depth image and final point cloud

```bash
python process_exr.py
```
4. Combine all point cloud, downsampling,remove noise

```bash
python combine_points.py
```

5. Generate video from ply

```bash
python all_direction_show_model.py
```

6. Put the video in [Vid2Curve](https://github.com/totoro97/vid2curve) to get 3d curve
## Reference

+ https://www.guyuehome.com/41655